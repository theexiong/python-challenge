import os

import csv

csvpath = os.path.join('Resources', 'budget_data.csv')

with open(csvpath) as csvfile:
    total = 0    
    average = 0
    row_count = 0
    pl = []
    dates = []
    changes = []
    previous_num = 0
    current_pl = 0
    difference = 0
    greatest_profit_date = ""
    greatest_profit_loss = ""
    csvreader = csv.reader(csvfile, delimiter=',')

    #print(csvreader)

    csv_header = next(csvreader)

    #print(f"CSV Header: {csv_header[1]}")

    #for row in csvreader:
         #print(row)
         #total = total + int(row[1])

    for row in csvreader:
        row_count += 1
        total += int(row[1])

        pl.append(int(row[1]))

    #print(pl)

        difference = int(row[1]) - previous_num
        dates.append(row[0])
        changes.append(difference)
        previous_num = int(row[1])
        difference = 0

    #go thru pl list find difference between two values 
    #for num in pl:
        #difference = num - previous_num
        #previous_num = num
        #add pl change to changes list
        #changes.append(difference)
        #difference = 0
        
    #print list of changes
    #print(changes)
    
    average = (pl[-1] - pl[0]) / (row_count - 1)

    greatest_profit = max(changes)

    greatest_loss = min(changes)

    greatest_profit_date = dates[changes.index(greatest_profit)]

    greatest_profit_loss = dates[changes.index(greatest_loss)]
    
print("\nFinancial Analysis\n")

print("------------------------------\n")

print("Total Months:", (row_count))

print(f'\nTotal: ${total}') 

print(f'\nAverage Change: ${average:.2f}')

print(f'\nGreatest Increase in Profits: {greatest_profit_date} (${greatest_profit})')

print(f'\nGreatest Decrease in Profits: {greatest_profit_loss} (${greatest_loss})')